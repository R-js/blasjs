const base64 = 
'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';
export type SYRKfn = (
    upper: boolean,
    transPose: boolean,
    n: number,
    k: number,
    alphaRe: number,
    alphaIm: number,
    betaRe: number,
    betaIm: number,
    isPacked: boolean
) => void;

type SYRKMap = {
    storage: WebAssembly.Memory
    syrkfp32: SYRKfn
    syrkfp64: SYRKfn
}

export default function initWasmSYRK(storage?: WebAssembly.Memory): SYRKMap {
    const binary = Buffer.from(base64, 'base64');
    const mod = new WebAssembly.Module(binary);
    const mem = storage ? storage : new WebAssembly.Memory({ initial: 1 });
    const instance = new WebAssembly.Instance(mod, { env: { matrices: mem } });
    return {
        storage: mem,
        syrkfp32: instance.exports.syrkfp32 as SYRKfn,
        syrkfp64: instance.exports.syrkfp64 as SYRKfn
    }
}